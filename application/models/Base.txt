create database Takalo;
use Takalo;
create table User(
	idUser int,
	nomUser varchar(50),
	prenom varchar(50),
	adresse varchar(50),
	mail varchar(30),
	motDePasse varchar(50),
	admin int,
	PRIMARY KEY (idUser)
);

create table Categorie(
	idCat int,
	nomCat varchar(50),
	PRIMARY KEY (idCat)
);

create table Objets(
	idObj int,
	idUser int,
	idCategorie int,
	prixEstimatif float,
	titreObjet varchar(50),
	descriObjet text,
	PRIMARY KEY (idObj),
	FOREIGN KEY (idUser) REFERENCES User (idUser),
	FOREIGN KEY (idCategorie) REFERENCES Categorie (idCat)
);

create table photos(
	idPhotos int,
	idObj int,
	url varchar(50),
	PRIMARY KEY (idPhotos),
	FOREIGN KEY (idObj) REFERENCES Objets (idObj)
);

create table Echange(
	idEch int,
	idUser1 int,
	idObj1 int,
	idUser2 int,
	idObj2 int,
	dateProp DATE,
	PRIMARY KEY (idEch),
	FOREIGN KEY (idUser1) REFERENCES User (idUser),
	FOREIGN KEY (idUser2) REFERENCES User (idUser),
	FOREIGN KEY (idObj1) REFERENCES Objets (idObj),
	FOREIGN KEY (idObj2) REFERENCES Objets (idObj)
);

create table Etat(
	idEtat int,
	etat int,
	PRIMARY KEY (idEtat)
);


CREATE TABLE StatEchange(
	idStat int,
	idEchange int,
	dateAccept DATE,
	idEtat int,
	PRIMARY KEY (idStat),
	UNIQUE KEY (idEchange),
	FOREIGN KEY (idEchange) REFERENCES Echange (idEch)
);
